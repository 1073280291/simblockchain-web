P是在[0-1]范围内的加权参数。

全流程仿真的产块时间是自我配置还是自适应生成问题？交易吞吐量的限制

**区块链+空中信息网络**

如果当一个区块创建后前一个区块还未传播至一半节点，系统会报错误机制

中值块传播时间限制、废块率、块大小（吞吐量）

基于docker实现虚拟化，同时使用Pumba，它是一个用于Docker容器的混沌测试命令行工具。Pumba通过使容器化应用程序崩溃、模拟网络故障和stress-testing容器资源（cpu、内存、fs、io等）来扰乱容器。

异常流程回卷  

蒙特卡洛模拟

多流程模型

simpy重构为java

信任节点（0.87）与非信任节点（0.67）之间的差距在于链接时成功率差距(欧几里德距离)

![1666531695533](C:\Users\10732\AppData\Local\Temp\1666531695533.png)

结合simblock的邻居选择算法}}}}   图的最小生成树

仿真节点可信机制（族内所有节点：直接信任值与间接信任值，简介情况下考虑统计的基本信任度（族内全局信任度），同时考虑节点的恶意历史来修改信任度）。族间信任度

以太坊采用全分布式结构化拓扑结构

心跳机制

我们这里说的心跳是指应用层的keepalive机制(节点动态失活)

与非结构化拓扑相比，结构化拓扑具有良好的网络连通性

分叉链创建形式:手动按钮创建，多用户情况下操作性创建

模拟器遵循随机模拟模型，能够通过从概率分布中取样来表示随机现象。我们的模型被认为是动态的，因为它们可以代表一定时间间隔内的系统。离散事件仿真模型适合于模拟区块链系统，因为它在离散时间点改变状态，而与它们发生的实际时间无关。因此，模拟器可以跟踪成千上万只改变状态的节点和事件。

**区块链相关机制**： 泛洪机制，事务接收与分发（交易），数据分发(gossip)算法，节点间的TCP连接数量（到达节点的数据速率的可变性），M/G/1排队模型，块和事务流量需要在不同的队列中分开，节点存储未用完的交易输出(UTXOs)，即系统的状态。点可以在没有授权的情况下加入和离开网络，因此它们被称为无许可区块链(非许可链)

散列值（由节点验证的事务被链接到一个数据块中，只要该节点已经找到一个随机数(即随机数),该随机数被插入到块报头中，目的是获得具有所需数量的前导零的块散列；这种方法通常被称为工作证明，或PoW）

广播加速[Towards a Trust-Enhanced Blockchain P2P Topology for Enabling Fast and Reliable Broadcast](https://www.webofscience.com/wos/alldb/full-record/WOS:000542964800019)

## 1、仿真驱动方法（仿真模型）对象模型：区块链，

DES是一种模拟范例，因其可用性和模拟复杂系统的能力而备受赞赏[13]。在DES中，模拟模型通过一组状态变量来表示，模型演变通过按时间顺序处理事件来建模。为了遵守现实世界中事件的因果关系约束，每个模拟事件都被打上时间戳(即在模拟时间的特定时刻发生)，并且它表示状态变量的变化。从实现的角度来看，模拟系统中的变化可以看作是对模拟模型中带有时间戳的事件的有序序列的处理。

在整体(即顺序)仿真中，代表仿真模型的所有模型状态变量被分配在单个物理执行单元(PEU)中，该物理执行单元负责生成新事件、管理未决事件列表以及处理按照时间戳顺序从有序列表中提取的事件。这种模拟器非常简单，可以使用单个执行进程来实现。另一方面，这种模拟器的简单性通常是以性能和可伸缩性为代价的。例如，就完成模拟运行所需的时间和可建模系统的复杂性而言，模拟器的可扩展性是有限的[10]。

另一种称为PADS的方法基于模拟器负载的并行化/分布。更具体地说，一组联网的peu(例如CPU内核、处理器或主机[6，13])负责执行模拟器。在这种情况下，仿真模型被划分为一组逻辑进程(LPs ),这些逻辑进程在参与并行/分布式仿真的peu之上执行。从实现的角度来看，每个LP管理一个本地未决事件列表和需要交付的事件在其他peu中分配的部分模拟模型被封装在消息中。PADS的主要优点是，它能够对与DES相关的更大、更复杂的模拟模型进行建模和处理。另一方面，模拟模型的划分并不容易[9]，需要一个LPs间的同步算法来保证正确的模拟执行

**离散事件驱动（离散事件是那些只有在那些某个时间点上的有事件发生时仿真系统状态才会发生改变，其中的各个变量状态是可列可数的，状态随时间的变化是间断性**----模糊离散事件模拟(FDES)

离散事件系统是状态仅在离散时间点发生变化的系统。在这样的系统中，正是事件导致了状态的变化，而状态的变化通常与事件的发生是一一对应的[1]. 目标系统的仿真类型不是由真实系统决定的，而是由描述真实系统的模型决定的。真实系统的描述不是唯一的，根据研究需要可以是连续系统或离散系统。离散事件系统模型所描述的目标系统的仿真称为离散事件系统仿真。

#### 基于OPNET的网络仿真模型中离散事件仿真机理研究

离散系统属于动基于OPET的网络仿真模型中离散事件仿真机理研究态类型仿真
由事件驱动（event），事件的发生（occur）是离散且随机的，即系统状态变量（state）的取值是依时间轴离散且随机分布的
此类系统无法用数学方程描述
DES使用两种事件推进机制：后续事件时间推进机制（next event time advance NETA)；固定步长时间推进机制（fixed increment time advance FITA）
**）**

	事件是网络模型状态的变化或者某种决策。只有模型状态变化，模拟机才进行仿真，状态不发生变化的时间段，不进行仿真。仿真的时间是离散的，每当有一个事件出现后时间往前推进，也就是时间是跳跃前进的。一个仿真时间点上可以同时出现多个事件，事件的发生可以有疏密的区别.
	仿真中的各个模块之间通过事件中断方式传递事件信息。每当出现一个事件中断时都会触发一个描述通信网络系统行为或者系统处理的进程模型的运行。通过离散事件驱动的仿真机制实现了在进程级描述通信的并发性和顺序性，再加上事件发生时刻的任意性，决定了可以仿真计算机和通信网络中的任何情况下的网络状态和行为。

**基于代理的仿真**（并行分布式仿真PADS：并行和分布式仿真关注的是通过将离散事件仿真程序的执行分布在多台计算机上而引入的问题。并行离散事件模拟涉及在包含多个中央处理单元(CPU)的多处理器计算平台上的执行，这些中央处理单元频繁地交互，例如每秒数千次。分布式模拟涉及在松散耦合的系统上执行模拟，其中交互花费更多的时间，例如几毫秒或更多，并且不经常发生。它包括在地理上分布的计算机上执行，这些计算机通过广域网如因特网相互连接。在这两种情况下，可能由几个仿真程序组成的单个仿真模型的执行分布在多台计算机上）：

**杰弗逊的开创性工作开发了时间扭曲算法(杰弗逊1985)。时间弯曲很重要，因为它定义了一类被称为乐观同步的算法中广泛使用的基本结构。保守和乐观同步技术构成了大量关于并行离散事件模拟技术的工作的核心**

Agent-based Simulation, ABS

	着重研究离散系统中的个体(agent)行为以及众多个体行为所导致的系统整体特征
	
	ABS是DES的衍生和变化(variation)
	Agent称为代理(个体、实体)，个体具有自治性，可以感知系统环境的变化以及系统中其他个体的行为，以所获得的信息进行决策并做出反应，个体具有记忆和思维的能力，依据既定的规则进行决策，还可以调整自身的行为以实现对系统的自适应(self-adaption)
	对于复杂系统而言，当众多个体遵从既定规则进行活动时，系统会产生涌现性(Emergence)，即系统表现出个体所不具备的特征

**基于虚拟化的（虚拟化为底层架构，在此架构下分别添加离散事件与代理仿真**

**）**（docker网络仿真）docker属于操作系统级虚拟化；操作系统虚拟化最大的特点就是不需要额外的supervisor支持，内核通过创建多个虚拟的操作系统实例来隔离不同的进程，容器相关技术就在这个范畴。在web服务器的场景下（相同硬件操作系统）具备更好的性能（并发用户的cpu性能差距，docker更稳定，docker操作性更强）

	在计算机技术中，虚拟化（Virtualization）是一种资管管理技术，是将计算机的各种实体资源，如服务器、网络、内存及存储等，予以抽象、转换后呈现出来，打破实体结构间的不可切割的障碍，使用户可以用比原本的组态更好的方式来应用这些资源。
	
	虚拟化的核心是对资源进行抽象，目标往往是为了在同一个主机上运行多个系统或应用，从而提高系统资源的利用率，同时带来降低成本、方便挂你了和容错容灾等好处
	
	**虚拟化类型（完全虚拟化，部分虚拟化，操作系统虚拟化）**
	
	**完全虚拟化**。利用硬件（主要是CPU）辅助支持（目前 x86 体系结构上可用的硬件辅助虚拟化技术包括 Intel-VT和AMD-V）处理敏感指令来实现完全虚拟化的功能，客户操作系统无需修改，例如VMware Workstation、Xen、KVM。
	**部分虚拟化**。只针对部分硬件资源进行虚拟化，客户操作系统需要进行修改。现在有些虚拟化技术的早期版本仅支持部分虚拟化。
	
	**操作系统级虚拟化**。内核通过创建多个虚拟的操作系统实例（内核和库）来隔离不同的进程。容器相关技术即在这个范畴。

**连续系统仿真**
	-连续系统仿真也属于动态类型(dynamic) 仿真，是一种基于活动(activity-based) 的仿真模式
	-仿真时钟将时间轴分成很多细小的连续的碎片(slice)，时钟沿着碎片有序地推进，系统变量在每个时间碎片上依据活动的动态变化进行相应的取值
	-**系统动力学仿真System Dynamic Simulation, SDS**
		多用于社会系统、商业、政府和军事等领域，重点解决政策评价和战略评估等方面的问题|
		SDS大多是确定型(deterministic) 的，但仿真模型具有纳入随机因素的能力
		SDS可以比DES处理层级更多、更复杂的系统分析，因而具有对宏观问题的仿真和分析能力

 

**仿真调度机制**

## 2、虚拟仿真实验平台的双向(基于某个入侵检测机制的双向处理)入侵检测机制（恶意行为检测与仿真），基于（双向）循环LSTM入侵检测机制（门内循环）

系统的入侵检测不是研究内容，而是必要（本应）的实现内容（基本系统需求）。流程仿真过程中的恶意行为仿真的目标研究内容，高可效与虚拟场景下的真实性。

###### **区块链上的三个类型的恶意行为**

**类型 I:用户管理服务器**（使用区块链分析的资产负债表完整性验证）

第一类入侵是指入侵者攻击用户管理

器。这包括窃取客户的帐户 id和密码来访问他们的帐户，攻击交易所的资产负债表以改变客户的余额，并添加虚假的买卖订单以获取经济利益。
**类型 II:签名服务器**（使用区块链分析的交 易验证 ）

 尽管拥有精心设计的安全参数和入侵检测系统，但存放比特币私钥的系统仍然是易受攻击的热门目标。第二类入侵是指入侵者直接攻击签名服务器来提取私钥。使用弱私钥的情况也属于这种类型。
**第三类:比特币网络**（51%的攻击检测）
第三类入侵涉及通过攻击整个比特币网络来间接攻击交易所。一种类型的攻击被称为 51%攻击，攻击者使用超过 50%的网络哈希来双倍花费比特币。

还有一些基本双花攻击等 eclipse攻击

###### **系统的恶意行为数据集及相关内容**

1. **MIT LL DARPA**

   该研究共模拟了 5 大类[网络攻击](https://www.zhihu.com/search?q=%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22article%22%2C%22sourceId%22%3A%22378446941%22%7D)：

   (1.Denial-Of-Service(DOS)：非法企图中断或干扰主机或网络的正常运行；

   (2.Remote to Local(R2L)：远程非授权用户非法获得本地主机的用户特权；

   (3.User to Root(U2R)：本地非授权用户非法获取本地超级用户或管理员的特权；

   (4.Surveillance or probe(Probe)：非法扫描主机或网络，寻找漏洞、搜索系统配置或网络拓扑；

   (5.Date Compromise(data)：非法访问或修改本地或远程主机的数据。

   下载地址：[http://users.cis.fiu.edu/~lpeng/Datasets_detail.html](https://link.zhihu.com/?target=http%3A//users.cis.fiu.edu/~lpeng/Datasets_detail.html)也包含了很多常见的[入侵检测](https://www.zhihu.com/search?q=%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22article%22%2C%22sourceId%22%3A%22378446941%22%7D)数据集。

2. **NSL-KDD、KDD99**

   KDD99数据集，有dos,u2r,r21,probe等类型的攻击，和普通的正常的流量。

   Normal：正常记录

   DOS：拒绝服务攻击

   PROBE：监视和其他探测活动

   R2L：来自远程机器的非法访问

   U2R：普通用户对本地超级用户特权的非法访问

   NSL-KDD数据集是KDD 99数据集的改进，（1）NSL-KDD数据集的训练集中不包含冗余记录，所以分类器不会偏向更频繁的记录；

   （2）NSL-KDD数据集的测试集中没有重复的记录，使得检测率更为准确。

   （3）来自每个难度级别组的所选记录的数量与原始KDD数据集中的记录的百分比成反比。结果，不同机器学习方法的[分类率](https://www.zhihu.com/search?q=%E5%88%86%E7%B1%BB%E7%8E%87&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22article%22%2C%22sourceId%22%3A%22378446941%22%7D)在更宽的范围内变化，这使得对不同学习技术的准确评估更有效。

   （4）训练和测试中的记录数量设置是合理的，这使得在整套实验上运行实验成本低廉而无需随机选择一小部分。因此，不同研究工作的评估结果将是一致的和可比较的。

   KDD99下载：https://link.zhihu.com/?target=http%3A//kdd.ics.uci.edu/databases/kddcup99/kddcup99.html

   NSL-KDD下载：https://link.zhihu.com/?target=http%3A//nsl-kdd/

3. **CIC-IDS-2017和CIC-IDS-2018**

   加拿大通信安全机构（CSE）和网络安全研究院（CIC）合作并公布了入侵检测数据集CIC-IDS-2017和CIC-IDS-2018。

   CIC-IDS-2017和CIC-IDS-2018使用CICFlowMeter提取80多个网络流特征。其中包含了6个基本特征和70多个功能特征。但由于特征提取的工具CICFlowMeter版本不同，CIC-IDS-2017比[CIC-IDS-2018](https://www.zhihu.com/search?q=CIC-IDS-2018&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22article%22%2C%22sourceId%22%3A%22378446941%22%7D)少了一个功能特征。但是数据集的数据极度的不平衡。使用时还得对数据进行不平衡处理。

   基于HTTP,HTTPS,FTP,SSH,邮件协议构造了25个抽象的用户行为。（模拟真实网络背景）

   攻击包含Brute Force FTP，Brute Force SSH， DoS， Heartbleed（[OpenSSL缺陷](https://www.zhihu.com/search?q=OpenSSL%E7%BC%BA%E9%99%B7&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22article%22%2C%22sourceId%22%3A%22378446941%22%7D)）， Web Attack，Infiltration（渗透）， Botnet（僵尸网络） 和 DDos 8 种。

   数据集官网：[https://www.unb.ca](https://link.zhihu.com/?target=https%3A//www.unb.ca/)

   CIC-IDS-2017下载：[CIC-IDS-2017](https://link.zhihu.com/?target=http%3A//205.174.165.80/CICDataset/CIC-IDS-2017/)（需要先注册）

   CIC-IDS-2018下载：https://link.zhihu.com/?target=https%3A//aistudio.baidu.com/aistudio/datasetdetail/60692

4. UNSW-NB15

   数据集中一共包含了9种攻击:Fuzzers, Analysis, Backdoors, DoS, Exploits, Generic, Reconnaissance, Shellcode and Worms.

   数据集进行了训练集和测试集的分割。

   数据集官网：[The UNSW-NB15 Dataset Description](https://link.zhihu.com/?target=https%3A//mathpretty.com/wp-content/themes/begin/go.php%3Furl%3DaHR0cHM6Ly93d3cudW5zdy5hZGZhLmVkdS5hdS91bnN3LWNhbmJlcnJhLWN5YmVyL2N5YmVyc2VjdXJpdHkvQURGQS1OQjE1LURhdGFzZXRzLw%3D%3D)

   数据集下载：[UNSW-NB15](https://link.zhihu.com/?target=https%3A//mathpretty.com/wp-content/themes/begin/go.php%3Furl%3DaHR0cHM6Ly9jbG91ZHN0b3IuYWFybmV0LmVkdS5hdS9wbHVzL2luZGV4LnBocC9zLzJEaG5MR0RkRUVDbzR5cz9wYXRoPSUyRlVOU1ctTkIxNSUyMC0lMjBDU1YlMjBGaWxlcw%3D%3D)


## 3、仿真虚拟时间控制机制

**python调用服务，前端调用python接口来进行相关调用，包括仿真时间推进，缩减，基于实际准确性**
时间推进法的基本原理是，固定一个时间增量，在设定起始时间后，在起始时间的基础上根据时间的增量来对时间进行推进模拟，也被称为周期扫描法。采用这种方法，仿真的时钟是按照时间增量的长度来逐步推进的，相当于每当时间增加一个单位时间后，就要对当前的事件进行模拟和判断。这种方法不是连续的，它也不能像真实世界中那样能够得到任意时间点可能发生的事件，而只能在相隔时间增量的节点上，得到事件变化的结果，其特点就像是每次事件都只发生在跳跃的时间点上，而在跳跃的时间点外不发生。

DES使用两种事件推进机制：后续事件时间推进机制（next event time advance NETA)；固定步长时间推进机制（fixed increment time advance FITA）（根据仿真结果需求来获取推进机制）

## 4、仿真平台的多人协同仿真机制（限制于单流程），协同仿真（仿真联盟，联邦）

基于两个构建块:节点虚拟化和时间虚拟化。节点虚拟化[9]允许在一个物理节点上运行多个虚拟节点，运行被测软件(SuT)。时间虚拟化[7]为虚拟节点提供了一个独立于实时的虚拟时间。真实时间和虚拟时间的商称为时间膨胀因子τ。将虚拟节点的时钟减慢τ会以相同的系数降低物理节点的负载。

 	**智能合约的仿真 、多人协同仿真，矿池以及交易所模拟（适用于全流程）**

	比如发生挖矿模拟，时间则快速推进至目标挖矿值时的时间（基于用户行为的时间推进机制）

RTI响应时间指数

并行分布式仿真情况下的时间推进机制（HLA/DEVS）

单流程仿真优化伪**分布式交互仿真系统**（）

## 5、其他知识

信任链
## 6仿真指标
块传播时间:这是从发送到接收块所用的时间。

交易传播时间:从发送到接收交易所需的时间。

实际块大小:这是模拟期间生成的平均块大小。

事务吞吐量:这是在定义的时间段内一组有效提交事务的速率。

网络延迟:网络中的总延迟。

生成块的数量:这是模拟期间生成块的总数。

有效块数:模拟过程中创建的有效块数。

块验证时间:这是在模拟期间验证生成的块所需的平均时间。

叔叔或陈旧块:这是在模拟期间生成的叔叔/陈旧块的数量。

分叉分辨率:反映在模拟过程中是否出现过分叉。

待定交易:这是模拟器在等待确认时跟踪交易号的能力。

挖掘难度:即分配给每笔交易的难度。

采矿奖励:这是整个模拟过程中发生的采矿过程所使用的奖励金额。

处理速度:这是模拟器在模拟期间执行特定任务所用的平均时间。

系统稳定性:这关系到区块链网络参与节点在分类账副本方面的最终一致性



## 6仿真流程模型

普通单流程（初学版）

多人协同版单流程：当无用户操作时，默认持续进行区块传输消息与交易广播消息

全流程



**时间扭曲机制**(Jefferson 1985)是最著名的乐观方法。当LP收到时间戳小于它已经处理的一个或多个事件的事件时，它会回滚并按时间戳顺序重新处理这些事件。回滚事件包括将LP的状态恢复到处理事件之前存在的状态(为此采用检查点)，以及“取消发送”由回滚的事件发送的消息。提供了一种称为反消息的优雅机制来“解除”消息。





## 7仿真信任机制(模糊理论尝试用于此处)

PeerTrust中，一个对等点的可信度是由它在过去向其他对等点提供服务时收到的对该对等点的评估来定义的。这种声誉反映了社区中的其他对等体基于他们过去的经历对给定对等体的信任程度。我们为这种评估确定了五个重要因素:(即节点从其他节点收到的反馈、节点执行的事务总数、反馈源的可信度、事务上下文因子和社区上下文因子)

1 .对等点从其他对等点获得的反馈，

2。反馈范围，如一个对等点与其他对等点的事务总数，

3。反馈源的可信度因子，

4。用于区分任务关键型事务和次要或非关键型事务的事务上下文因子，以及

5。解决社区相关特征和脆弱性的社区背景因素。

![1666774295785](C:\Users\10732\AppData\Local\Temp\1666774295785.png)





8验证内容：基于深度学习的验证。

DOS攻击的评估验证。

基于已有的模拟器进行对比实验

分布式仿真的代理信任机制

正确性，伸缩性扩展性，，交互性